# Mouse Movement Analysis Configuration File
# Zero Trust Telehealth Platform - Continuous Behavioral Authentication

# Model Configuration
model:
  name: "MouseDynamicsSiameseNet"
  embedding_dim: 128  # Behavioral embedding dimension
  hidden_dims: [256, 512, 512, 256, 128]
  dropout: 0.3
  activation: "relu"
  use_batch_norm: true
  architecture: "siamese"  # Siamese network with shared weights
  
# Feature Extraction
features:
  # Movement features
  velocity_features: true  # Speed and velocity profiles
  acceleration_features: true  # Acceleration patterns
  curvature_features: true  # Movement curvature and angular variations
  jerk_features: true  # Rate of change of acceleration
  
  # Click dynamics
  click_features: true
  click_hold_duration: true  # Time between mousedown and mouseup
  double_click_interval: true
  click_pressure: false  # Not available in Balabit dataset
  
  # Scrolling patterns
  scroll_features: true
  scroll_velocity: true
  scroll_rhythm: true
  
  # Trajectory features
  trajectory_length: true
  trajectory_straightness: true
  trajectory_efficiency: true  # Ratio of direct distance to actual path
  
  # Statistical features
  use_statistics: true
  statistics: ["mean", "std", "median", "min", "max", "q25", "q75", "skew", "kurtosis"]
  
  # Temporal features
  pause_duration: true  # Time between movements
  movement_bursts: true  # Rapid movement sequences
  
  # Window settings
  window_size: 100  # Number of mouse events per window
  sliding_window: true
  window_stride: 50
  min_events: 50  # Minimum events for feature extraction

# Training Configuration
training:
  batch_size: 32
  epochs: 100
  learning_rate: 0.0001
  weight_decay: 0.0001
  optimizer: "adam"
  scheduler: "cosine"
  early_stopping_patience: 20
  
  # Loss function
  loss_type: "triplet"  # triplet loss for Siamese network
  triplet_margin: 1.0
  triplet_mining: "hard"  # hard, semi-hard, or all
  
  # Data split
  train_ratio: 0.6
  val_ratio: 0.2
  test_ratio: 0.2
  
  # Augmentation
  use_augmentation: true
  noise_level: 0.02
  time_warping: true
  spatial_jitter: 0.05  # Pixel jitter for robustness

# Verification Configuration
verification:
  similarity_metric: "cosine"  # cosine, euclidean, or manhattan
  threshold: 0.70  # Adjustable threshold for authentication
  target_accuracy: 0.875  # Target 85-90% accuracy
  
  # Continuous verification
  verification_window: 30  # seconds
  min_movements: 50  # Minimum mouse events for verification
  update_frequency: 10  # seconds between verifications
  
  # Confidence scoring
  confidence_levels:
    high: 0.85
    medium: 0.70
    low: 0.55
  
  # Alert thresholds
  alert_threshold: 0.65
  critical_threshold: 0.50

# Anomaly Detection
anomaly_detection:
  enabled: true
  method: "isolation_forest"  # isolation_forest, one_class_svm, autoencoder
  contamination: 0.1
  
  # Behavioral anomalies
  detect_automated_behavior: true  # Detect scripts/bots
  detect_remote_desktop: true  # Detect RDP artifacts
  detect_substitution: true  # Detect user substitution
  
  # Specific anomaly patterns
  detect_linear_movements: true  # Unnatural straight lines
  detect_constant_velocity: true  # Robotic movement
  detect_impossible_speed: true  # Physically impossible movements
  
  # Thresholds
  anomaly_score_threshold: 0.7
  consecutive_anomalies_alert: 5

# Enrollment Configuration
enrollment:
  min_samples: 100  # Minimum mouse events for enrollment
  max_samples: 1000  # Maximum events to store
  enrollment_sessions: 3  # Number of sessions for robust enrollment
  
  # Few-shot learning
  few_shot_enabled: true
  min_few_shot_samples: 50
  
  # Template update
  adaptive_templates: true
  template_update_rate: 0.05  # Weight for new samples

# Security Configuration
security:
  encryption_enabled: true
  tls_version: "1.3"
  store_raw_data: false  # Only store embeddings
  data_retention_days: 90
  
  # Privacy
  anonymize_data: true
  gdpr_compliant: true

# API Configuration
api:
  host: "0.0.0.0"
  port: 8003
  workers: 4
  reload: false
  log_level: "info"
  
  # Rate limiting
  rate_limit_enabled: true
  requests_per_minute: 100
  
  # CORS
  cors_enabled: true
  allowed_origins: ["http://localhost:3000", "http://localhost:5000"]

# Logging Configuration
logging:
  level: "INFO"
  format: "{time:YYYY-MM-DD HH:mm:ss} | {level} | {message}"
  rotation: "100 MB"
  retention: "30 days"
  log_dir: "logs"

# Dataset Configuration
dataset:
  balabit_path: "Dataset"
  training_files: "Dataset/training_files"
  test_files: "Dataset/test_files"
  labels_file: "Dataset/public_labels.csv"
  cache_dir: "cache"

# Model Paths
paths:
  model_dir: "models"
  checkpoint_dir: "models/checkpoints"
  pretrained_dir: "models/pretrained"
  embeddings_dir: "models/embeddings"
  logs_dir: "logs"
  temp_dir: "temp"

# Performance Targets (as per requirements)
performance:
  target_accuracy: 0.875  # 85-90% target accuracy
  verification_latency_ms: 500  # 500ms max latency
  throughput_requests_per_sec: 50

# Monitoring
monitoring:
  enabled: true
  metrics_port: 9003
  health_check_interval: 30
  audit_logging: true  # Detailed audit logs for forensic analysis


