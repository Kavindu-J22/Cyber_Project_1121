# Keystroke Dynamics Configuration File
# Zero Trust Telehealth Platform - Continuous Authentication

# Model Configuration
model:
  name: "KeystrokeDynamicsNet"
  embedding_dim: 128  # Behavioral embedding dimension
  hidden_dims: [256, 512, 256, 128]
  dropout: 0.3
  activation: "relu"
  use_batch_norm: true
  
# Feature Extraction
features:
  # Timing features
  hold_times: true  # H.key - time key is held down
  dd_times: true    # DD.key1.key2 - keydown to keydown
  ud_times: true    # UD.key1.key2 - keyup to keydown
  
  # Statistical features
  use_statistics: true
  statistics: ["mean", "std", "median", "min", "max", "q25", "q75"]
  
  # Sequence features
  sequence_length: 50  # Number of keystrokes to analyze
  sliding_window: true
  window_stride: 10
  
  # Advanced features
  typing_speed: true
  rhythm_patterns: true
  pressure_variance: true  # If available from hardware

# Training Configuration
training:
  batch_size: 32
  epochs: 100
  learning_rate: 0.001
  weight_decay: 0.0001
  optimizer: "adam"
  scheduler: "cosine"
  early_stopping_patience: 15
  
  # Loss function
  loss_type: "triplet"  # triplet, contrastive, or cross_entropy
  triplet_margin: 0.5
  
  # Data split
  train_ratio: 0.6
  val_ratio: 0.2
  test_ratio: 0.2
  
  # Augmentation
  use_augmentation: true
  noise_level: 0.05
  time_warping: true

# Verification Configuration
verification:
  similarity_metric: "cosine"  # cosine, euclidean, or mahalanobis
  threshold: 0.75  # Adjustable threshold for authentication
  eer_target: 0.05  # Target Equal Error Rate (5%)
  
  # Continuous verification
  verification_window: 30  # seconds
  min_keystrokes: 20  # Minimum keystrokes for verification
  update_frequency: 5  # seconds between verifications
  
  # Confidence scoring
  confidence_levels:
    high: 0.90
    medium: 0.75
    low: 0.60
  
  # Alert thresholds
  alert_threshold: 0.60
  critical_threshold: 0.50

# Anomaly Detection
anomaly_detection:
  enabled: true
  method: "isolation_forest"  # isolation_forest, one_class_svm, autoencoder
  contamination: 0.1
  
  # Behavioral anomalies
  detect_speed_anomalies: true
  detect_rhythm_anomalies: true
  detect_pattern_anomalies: true
  
  # Thresholds
  anomaly_score_threshold: 0.7
  consecutive_anomalies_alert: 3

# Enrollment Configuration
enrollment:
  min_samples: 50  # Minimum typing samples for enrollment
  max_samples: 200  # Maximum samples to store
  enrollment_sessions: 3  # Number of sessions for robust enrollment
  
  # Few-shot learning
  few_shot_enabled: true
  min_few_shot_samples: 10
  
  # Template update
  adaptive_templates: true
  template_update_rate: 0.1  # Weight for new samples

# Security Configuration
security:
  encryption_enabled: true
  tls_version: "1.3"
  store_raw_data: false  # Only store embeddings, not raw keystroke data
  data_retention_days: 90
  
  # Privacy
  anonymize_data: true
  gdpr_compliant: true

# API Configuration
api:
  host: "0.0.0.0"
  port: 8002
  workers: 4
  reload: false
  log_level: "info"
  
  # Rate limiting
  rate_limit_enabled: true
  requests_per_minute: 100
  
  # CORS
  cors_enabled: true
  allowed_origins: ["http://localhost:3000", "http://localhost:5000"]

# Logging Configuration
logging:
  level: "INFO"
  format: "{time:YYYY-MM-DD HH:mm:ss} | {level} | {message}"
  rotation: "100 MB"
  retention: "30 days"
  log_dir: "logs"

# Dataset Configuration
dataset:
  dsl_path: "Dataset/DSL-StrongPasswordData-Original_Dataset.xls"
  tuplet_path: "Dataset/tuplet_dataset_with_subjects1.xlsx"
  cache_dir: "cache"
  
# Model Paths
paths:
  model_dir: "models"
  checkpoint_dir: "models/checkpoints"
  pretrained_dir: "models/pretrained"
  embeddings_dir: "models/embeddings"
  logs_dir: "logs"
  temp_dir: "temp"

# Performance Targets (as per requirements)
performance:
  eer_threshold: 0.05  # 5% EER target
  verification_latency_ms: 500  # 500ms max latency
  throughput_requests_per_sec: 50
  
# Monitoring
monitoring:
  enabled: true
  metrics_port: 9002
  health_check_interval: 30

